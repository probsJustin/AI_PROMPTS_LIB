# Claude Code Ultra-Prompt: Build a Modular, Agentic, Dockerized MCP Server with Parallel Claude Execution

You are tasked with building an **automated, modular MCP (Model Control Plane) server** that combines and extends multiple advanced features. This system must function as a **permanent feature of Claude Code**, requiring **no repeated manual explanations or reconfigurations**.

---

## üèóÔ∏è Core System Features

1Ô∏è‚É£ **Agentic, Modular MCP Server**  
- Built with **object-oriented design principles** for extensibility.  
- Supports **module injection and execution** via MCP tools.  
- Integrated with **Discord webhooks** for communication and event notifications.  
- **OpenTelemetry (OTel)** instrumentation for observability and tracing.  

2Ô∏è‚É£ **Dockerized Execution with Parallel Claude Instances**  
- The MCP server must run in a **Docker container**.  
- Inside the container, launch **Claude instances with `--dangerously-skip-permissions`** to execute tasks in parallel.  
- **Claude instances must be able to execute prompts generated by the main MCP server**, including project research plans, code generation tasks, and structured instructions.  
- Claude instances generate research, code, and project plans, and then output files to `/workspace/repo`.  
- The parent Claude (running the MCP server) can **pull and integrate these outputs** into the main repository.  
- All generated files must be **immediately downloadable and Git tracked**.  

3Ô∏è‚É£ **Automated Project & Research Workflow**  
- When a project or research task arises:  
  - Create a timestamped folder in `/repos/notes/projects/YYYYMMDD_HHMM_<topic>` or `/repos/notes/research/YYYYMMDD_HHMM_<topic>`.  
  - Generate a markdown file with:  
    - General research and insights (researched by Claude).  
    - Multi-step implementation plan with code examples and architecture diagrams (in Markdown).  
    - Comprehensive metadata (`tags`, `updated_at`, author, status).  
  - Use the MCP server to **commit and push** changes to GitHub with UUID-tagged messages.  

4Ô∏è‚É£ **Execute Research Prompts Automatically**  
- After generating a **project research plan**, the MCP server must:  
  - **Parse the generated prompts** into executable tasks for separate Claude instances.  
  - **Launch parallel Claude instances** (in Docker) to execute these tasks, generate output files, and write them into the appropriate folders.  
  - **Collect and integrate the outputs** back into the main repo, committing and pushing changes as necessary.  
  - This creates an **automated loop** where Claude generates a project plan and then implements it via parallel instances.  

5Ô∏è‚É£ **Seamless Notes Management**  
- For new or updated notes:  
  - Add the content to `/repos/notes/notes/YYYYMMDD_HHMM_<topic>.md` with metadata.  
  - Auto-commit and push changes.  

6Ô∏è‚É£ **Persistent Git Integration**  
- The server must **check for new commits in the remote GitHub repository** (`GITHUB_REPO`) and pull them if available.  
- Automatically **add, commit (with UUIDs and structured metadata), and push** any local changes.  
- Push after **every discrete action** (project generation, note update, research addition).

---

## üß™ Testing Framework  
- Develop a **comprehensive automated test suite** that validates:  
  - Git pull/push functionality.  
  - Correct folder/file generation and naming.  
  - Metadata integrity in markdown files.  
  - Proper OTel tracing integration.  
  - Docker container health and Claude instance management.  
  - **Successful execution of generated prompts by Claude instances**, with output verification.  
- Run the test suite **before any actions** are executed.

---

## üìö Comprehensive Documentation & Workflow  
- Create a detailed **README.md** explaining:  
  - How the system works from start to finish.  
  - The precise **workflow** for creating research, projects, and notes.  
  - How **Claude instances are launched in Docker** and how outputs are integrated.  
  - **How generated project prompts are automatically executed** by Claude instances to produce deliverables.  
  - How the system **automatically manages Git commits and pushes**.  
  - Example folder structures, commit messages, and metadata formats.  
  - Troubleshooting for common issues (e.g., git push rejected, Docker network errors, OTel misconfigurations).  
- This documentation must be **self-contained and sufficient** to onboard any new user without needing further explanations from me.

---

## üåê Persistent & Automated Feature (Critical)  
- This entire system must be built as a **new, persistent workflow integrated into Claude Code itself**.  
- It should run **automatically and seamlessly** as part of Claude‚Äôs capabilities.  
- **I do not want to explain or configure this process again after the initial setup**.  
- All configuration (e.g., `GITHUB_REPO`, Docker settings, folder structures) should be persisted and only modifiable via explicit prompts or updates.

---

## üì¶ Output Expectations  
- **app.py**: Complete Python MCP server with all features (Discord, OTel, Dockerized execution, Git management, prompt execution).  
- **Dockerfile** and **docker-compose.yaml** for running the MCP server and Claude instances.  
- **test_mcp_server.py**: Comprehensive test suite.  
- **README.md**: Clear, detailed documentation.  
- Ready-to-use **GitHub repository structure** with sample folders and files.  

---

### üåà Special Notes
- Consistent **timestamped file/folder naming** (`YYYYMMDD_HHMM_<topic>`).  
- Use **Python GitPython**, FastAPI, and appropriate Docker orchestration.  
- Prioritize **modularity and maintainability**.  
- **Minimize direct code changes**: use documentation, prompts, and modular design wherever possible.  
- **Automatically parse and execute generated research/project prompts** inside Claude instances, creating a self-sustaining system.  

**Input Variables:**  
- `GITHUB_REPO`, `GIT_USERNAME`, `GIT_API` (for remote Git config).  

---

Your mission: Deliver a robust, automated, production-ready MCP system that **creates, executes, and integrates project prompts automatically** ‚Äì with no further explanations required.
